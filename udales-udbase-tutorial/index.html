
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the building-resolving urban multi-physics code uDALES">
      
      
        <meta name="author" content="The uDALES Team">
      
      
        <link rel="canonical" href="https://uDALES.github.io/u-dales/udales-udbase-tutorial/">
      
      
        <link rel="prev" href="../udales-post-processing/">
      
      
        <link rel="next" href="../udales-fields-tutorial/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>udbase - uDALES</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-udales-post-processing-with-matlab" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="uDALES" class="md-header__button md-logo" aria-label="uDALES" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            uDALES
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              udbase
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/uDALES/u-dales" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    u-dales
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="uDALES" class="md-nav__button md-logo" aria-label="uDALES" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    uDALES
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/uDALES/u-dales" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    u-dales
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Simulation inputs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Simulation inputs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-namoptions-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    List of input parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-boundary-conditions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Boundary conditions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-geometry-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Geometry generation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-copy-inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Copying from other simulations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-driver-simulations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Precursor simulations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Running the simulation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Running the simulation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-pre-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pre-processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-simulation-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running uDALES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-post-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Post-processing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data post-processing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Data post-processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    udbase
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    udbase
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initialising-udbase" class="md-nav__link">
    <span class="md-ellipsis">
      Initialising udbase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-simulation-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing simulation properties
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-fields-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flow fields and statistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-facets-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Facets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-utility-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utility routines
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-example-simulations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example simulations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-how-to-cite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to cite
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-pub-list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publication list
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEVELOP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development notes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to contribute
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../udales-docs-software/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Software docs
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initialising-udbase" class="md-nav__link">
    <span class="md-ellipsis">
      Initialising udbase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-simulation-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing simulation properties
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="introduction-to-udales-post-processing-with-matlab">Introduction to uDALES post-processing with MATLAB<a class="headerlink" href="#introduction-to-udales-post-processing-with-matlab" title="Permanent link">&para;</a></h1>
<p>This tutorial describes how to read and process facet data of the LES code uDALES using MATLAB. This tutorial introduces the <code>udbase</code> post-processing class. There are separate tutorials for processing field files and facet files.</p>
<p>The <strong><code>udbase</code></strong> post-processing class reads in most important input parameters, and contains a number of methods to load field and facet data.</p>
<p><strong>Field data:</strong></p>
<ul>
<li><strong>load_stat_xyt</strong>. This method load the 1D slab- and time-averaged statistics from the file <code>xytdump.expnr.nc</code>. Several time-intervals may be present in the data.</li>
<li><strong>load_stat_t</strong>. This method loads the 3D time-averaged statistics from the file <code>tdump.expnr.nc</code>. Several time-intervals may be present in the data.</li>
<li><strong>load_stat_tree</strong>. This method loads the 3D time-averaged statistics of the tree source terms from the file <code>treedump.expnr.nc</code>. This method works exactly the same way as <code>load\\_stat\\_t</code>.</li>
<li><strong>load_field</strong>. This method loads instantaneous 3D data from the file <code>fielddump.expnr.nc</code>. Several output times may be present in the data.</li>
<li><strong>load_slice</strong>. This method loads instantaneous 2D slices of instantaneous 3D data from the file <code>Xslicedump.expnr.nc</code>. Several output times may be present in the data.</li>
</ul>
<p><strong>Facet data:</strong></p>
<ul>
<li><strong>calculate_frontal_properties</strong>. This method calculates the skylines, frontal areas and blockage ratios in the x- and y-direction.</li>
<li><strong>plot_fac_type</strong>. This method displays the type of surface for each facet.</li>
<li><strong>assign_prop_to_fac</strong>. This method assigns a property of the facet type to each of the facets, so it can be used for calculation and visualisation</li>
<li><strong>plot_fac</strong>. This method displays a surface variable on the mesh.</li>
<li><strong>load_fac_momentum</strong>. This method loads instantaneous momentum surface data from <code>fac.expnr.nc</code>. The first index is the facet id and second index is time.</li>
<li><strong>load_fac_eb</strong>. This method loads instantaneous surface energy balance data from <code>facEB.expnr.nc</code>. The first index is the facet id and second index is time.</li>
<li><strong>load_seb</strong>. This method loads all instantaneous surface energy balance terms. The first index is the facet id and second index is time.</li>
<li><strong>load_fac_temperature</strong>. This method loads instantaneous facet temperature data <code>facT.expnr.nc</code>. The first index is the facet id, the second is the layer index and the third index is time.</li>
<li><strong>area_average_seb.</strong> This method calculates the area-averaged surface energy balance from the facet surface energy balances obtained using <code>load_seb</code>.</li>
<li><strong>area_average_fac.</strong> This method performs area-averaging over (a selection of) the facets. The facet index is assumed to be the first index of the array.</li>
<li><strong>plot_trees.</strong> This method volumetric tree blocks along with the STL geometry.</li>
<li><strong>convert_facflx_to_field</strong>. This method converts a facet variable to a density in a 3D field, so it can be used for post-processing (e.g. calculating distributed drag).</li>
<li><strong>convert_facvar_to_field</strong>. This method assigns facet variables to the 3D grid, so it can be used for post-processing (e.g. averaging over y).</li>
</ul>
<p><strong>The live matlab file of this tutorial can be found in the repository in the folder /docs/tutorial_mlx.</strong></p>
<h2 id="initialising-udbase">Initialising udbase<a class="headerlink" href="#initialising-udbase" title="Permanent link">&para;</a></h2>
<p>The starting point of this tutorial is that you have run a simulation and have merged the output files. If the simulations were performed on a HPC system, <strong>we assume that you have copied the output directory to your own workstation</strong>. Some of the netCDF (*.nc) files may be very large and you may only want to copy these if you plan to analyse the data.</p>
<p>The uDALES postprocessing class is called <code>udbase</code>. Typically, you will create a post-processing script in the output directory on your workstation, but it is also possible to have the output directory located in another directory. This is particularly useful if you are comparing several different simulations at the same time. Here, we will show how to use data from simulation 065 (<code>expnr=065)</code> that is located in a different directory from the one you are working in.</p>
<p><strong>Note that the uDALES/tools/matlab path must be added via the Set Path button in order to use the udbase class. Alternatively, it can be added using the addpath function inside the script (done here).</strong></p>
<div class="highlight"><pre><span></span><code><span class="c">% preamble</span>
<span class="nb">clear</span><span class="w"> </span><span class="n">variables</span>
<span class="nb">close</span><span class="w"> </span><span class="nb">all</span>

<span class="c">% add the uDALES matlab path</span>
<span class="nb">addpath</span><span class="p">(</span><span class="s">&#39;path_to_udales\tools\matlab&#39;</span><span class="p">)</span>

<span class="c">% create an instance of the udbase class</span>
<span class="n">expnr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">065</span><span class="p">;</span>
<span class="n">expdir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;path_to_experiments\065&#39;</span><span class="p">;</span>

<span class="n">sim</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">udbase</span><span class="p">(</span><span class="n">expnr</span><span class="p">,</span><span class="w"> </span><span class="n">expdir</span><span class="p">);</span>
</code></pre></div>
<p>The constructor can have a number of input parameters:</p>
<div class="highlight"><pre><span></span><code><span class="nb">help</span><span class="w"> </span><span class="n">udbase</span><span class="p">.</span><span class="n">udbase</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>  Class constructor.

  udbase(expnr, dapath, load_preprocdata)
     expnr:                       experiment number
     dapath (optional):           path to the experiment

  Example:
    obj = udbase(expnr, &#39;/path/experiments/../100&#39;);

    Documentation for udbase/udbase
</code></pre></div>
<p>The constructor of the <code>udbase</code> class reads in the following files:</p>
<ul>
<li><code>namoptions.expnr. C</code>ontains the simulation input parameters.</li>
<li><code>xxx.stl.</code> Contains the urban geometry used for the simulation [optional].  </li>
</ul>
<p>Provided that <code>load_preprocdata</code> is not set to false, the constructor of the <code>udbase</code> class additionally reads the following files:</p>
<ul>
<li><code>solid_(u,v,w,c).txt.</code> Contains the indices of the (u,v,w,c)-volumes occupied by buildings.</li>
<li><code>facets.inp</code>. Contains information about the facet wall type and surface normal.</li>
<li><code>factypes.inp</code>. Contains information about the properties of the wall types.</li>
<li><code>facetarea.inp</code>. Contains information about the facet areas.</li>
<li><code>fluid_boundary_(u,v,w,c).txt</code>. Contains information about the fluid cells associated with facet sections.</li>
<li><code>facet_sections_(u,v,w,c).txt</code>. Information about facet section area, distance and flux point.</li>
</ul>
<h2 id="accessing-simulation-properties">Accessing simulation properties<a class="headerlink" href="#accessing-simulation-properties" title="Permanent link">&para;</a></h2>
<p>To view all simulation input parameters, simply type</p>
<div class="highlight"><pre><span></span><code><span class="n">sim</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>sim =
  udbase with properties:

              expnr: &#39;065&#39;
               geom: [1x1 udgeom.udgeom]
                 xm: [64x1 double]
                 ym: [64x1 double]
                 zm: [64x1 double]
                 xt: [64x1 double]
                 yt: [64x1 double]
                 zt: [64x1 double]
                 dx: 1
                 dy: 1
                dzm: [64x1 double]
                dzt: [64x1 double]
                 Su: [64x64x64 logical]
                 Sv: [64x64x64 logical]
                 Sw: [64x64x64 logical]
                 Sc: [64x64x64 logical]
               facs: [1x1 struct]
           factypes: [1x1 struct]
             facsec: [1x1 struct]
              trees: []
         stl_ground: 1
               ktot: 64
          fieldvars: &#39;&#39;v0,th,qt,u0,w0&#39;&#39;
           lBImin_w: 0
         iwallmoist: 2
          nbndpts_c: 5164
          lbuoyancy: 1
           lBImin_c: 0
          nsolpts_c: 3488
           iadv_thl: 2
         nfctsecs_c: 7940
          nbndpts_v: 5208
               thl0: 301
              rsmin: 200
             iexpnr: 65
              skyLW: 395
                z0h: 6.7000e-05
             wgrmax: 451
              dtfac: 10
           lxytdump: 1
         tstatsdump: 5
                 z0: 0.0100
          lvfsparse: 1
       solarazimuth: 135
               flrT: 298
             wtsurf: 0
         nfctsecs_w: 2817
             ltdump: 0
         lfielddump: 0
                  I: 814
               ylen: 64
         tfielddump: 11
               itot: 64
         nfctsecs_u: 11214
                 u0: 2
          uflowrate: 5
               jtot: 64
             min_vf: 0.0100
              zsize: 64
                nnz: 909975
               xlen: 64
               libm: 1
           lBImin_v: 0
           nfaclyrs: 5
          nsolpts_v: 3696
        solarzenith: 45
           fraction: 0.5000
              nfcts: 2658
          igrw_damp: 0
            tsample: 1
          nsolpts_u: 3856
    lperiodicEBcorr: 1
             wqsurf: 0
               maxD: 64
                qt0: 0.0100
            iadv_qt: 2
             nprocx: 8
           stl_file: &#39;geom.065.stl&#39;
              randu: 0.0100
              lflat: 1
              dtmax: 5
           trestart: 51000
       diag_neighbs: 0
             nprocy: 4
            irandom: 43
           lBImin_u: 0
          nbndpts_u: 5208
             lmoist: 1
            ltempeq: 1
         lrandomize: 1
               Dsky: 107.2000
              GRLAI: 2.1000
          nsolpts_w: 7584
             ipoiss: 0
          ladaptive: 1
               dtEB: 1
         nfctsecs_v: 12010
         luvolflowr: 1
         lvoutflowr: 0
                wfc: 314
          vflowrate: 0
      lwriteEBfiles: 1
                 ps: 101300
            runtime: 10000
               facT: 301
           sinkbase: 32
          iwalltemp: 2
               bldT: 298
            lconstW: 1
          lwritefac: 1
            lvreman: 1
              wsoil: 250
                lEB: 1
              wwilt: 172
          nbndpts_w: 5164
</code></pre></div>
<p>For a complete list of parameters and their meaning, please consult the pre-processing documentation. Some commonly used parameters are</p>
<ul>
<li><code>xlen</code>, <code>ylen</code> and <code>zsize</code> that represent the domain size</li>
<li><code>itot</code>, <code>jtot</code> and <code>ktot</code> that represent the total number of grid cells</li>
</ul>
<p>To access a parameter directly, use the syntax <code>object.prop</code>. To access the domain length in x-direction, use</p>
<div class="highlight"><pre><span></span><code><span class="n">sim</span><span class="p">.</span><span class="n">xlen</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>ans = 64
</code></pre></div>
<p>The geometry stored in the STL file, if present, has been also loaded, which can be visualised using the method below. This method will produce an error if STL file does not exist or been loaded.</p>
<div class="highlight"><pre><span></span><code><span class="n">sim</span><span class="p">.</span><span class="n">geom</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
</code></pre></div>
<p><img alt="figure_0.png" src="../udales-udbase-tutorial_media/figure_0.png" /></p>
<p>This shows all individual faces. Use <code>show_outline</code> to see the building outlines.</p>
<div class="highlight"><pre><span></span><code><span class="n">sim</span><span class="p">.</span><span class="n">geom</span><span class="p">.</span><span class="n">show_outline</span><span class="p">();</span>
</code></pre></div>
<p><img alt="figure_1.png" src="../udales-udbase-tutorial_media/figure_1.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      The uDALES Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>